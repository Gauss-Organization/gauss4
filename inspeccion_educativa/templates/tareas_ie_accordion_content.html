{% load entidades_extras %}
<div class="row">
    <div class="columns large-4">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Inspector</b><select class="selector" data-campo="inspector_mdb" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for i in inspectores %}
                    <option value="{{ i.0 }}" {% if instarea.tarea.inspector_mdb == i.0 %}selected{% endif %}>{{ i.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Inspector </b></label> {{ instarea.tarea.get_inspector_mdb_display }}
        {% endif %}
    </div>
    <div class="columns large-4">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Función inspectora</b><select class="selector" data-campo="funcion" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for f in funciones %}
                    <option value="{{ f.0 }}" {% if instarea.tarea.funcion == f.0 %}selected{% endif %}>{{ f.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Función inspectora </b></label> {{ instarea.tarea.get_funcion_display }}
        {% endif %}
    </div>
    <div class="columns large-2 end" style="text-align: center;">
        <label><b>¿Finalizada?</b></label>
        {% if g_e|has_permiso:'edita_cualquier_tarea_ie' %}
            <b class="center"><a class="realizada" data-id="{{ instarea.id }}"
                                 id="realizada{{ instarea.id }}">{% if instarea.tarea.realizada %}Sí{% else %}
                No{% endif %}</a></b>
        {% else %}
            <b>{% if instarea.tarea.realizada %}Sí{% else %}No{% endif %}</b>
        {% endif %}
    </div>
    <div class="columns large-2">
        {% if not instarea.tarea.realizada %}
            {% if instarea.inspector == g_e or g_e|has_permiso:'borra_cualquier_tarea_ie' %}
                <a class="button alert borrar_tarea_ie" data-id="{{ instarea.id }}">
                    <i class="fa fa-trash-o"></i> Borrar</a>
            {% endif %}
        {% endif %}
    </div>
</div>
<div class="row">
    <div class="columns large-12">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
        <label><b>Asunto: </b><input type="text" class="update_texto" data-campo="asunto" data-id="{{ instarea.id }}"
                                     value="{{ instarea.tarea.asunto }}" placeholder="Introduce aquí el nombre de la actuación"></label>
        {% else %}
            <label><b>Asunto: </b></label> {{ instarea.tarea.asunto }}
        {% endif %}
    </div>
</div>

<div class="row">
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
                <label><b>Tipo de actuación</b><select class="selector" data-campo="tipo" data-id="{{ instarea.id }}">
                    <option value="">---------</option>
                    {% for t in tipos %}
                        <option value="{{ t.0 }}" {% if instarea.tarea.tipo == t.0 %}selected{% endif %}>{{ t.1 }}</option>
                    {% endfor %}
                </select> </label>
            {% else %}
            <label><b>Tipo de actuación</b></label> {{ instarea.tarea.get_tipo_display }}
        {% endif %}
    </div>
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Actuación</b><select class="selector" data-campo="actuacion" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for a in actuaciones %}
                    <option value="{{ a.0 }}" {% if instarea.tarea.actuacion == a.0 %}selected{% endif %}>{{ a.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Actuación </b></label> {{ instarea.tarea.get_actuacion_display }}
        {% endif %}
    </div>
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Sector</b><select class="selector" data-campo="sector" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for s in sectores %}
                    <option value="{{ s.0 }}" {% if instarea.tarea.sector == s.0 %}selected{% endif %}>{{ s.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Sector </b></label> {{ instarea.tarea.get_sector_display }}
        {% endif %}
    </div>
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Nivel</b><select class="selector" data-campo="nivel" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for n in niveles %}
                    <option value="{{ n.0 }}" {% if instarea.tarea.nivel == n.0 %}selected{% endif %}>{{ n.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Nivel </b></label> {{ instarea.tarea.get_nivel_display }}
        {% endif %}
    </div>
</div>
<div class="row">
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Objeto</b><select class="selector" data-campo="objeto" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for o in objetos %}
                    <option value="{{ o.0 }}" {% if instarea.tarea.objeto == o.0 %}selected{% endif %}>{{ o.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Objeto </b></label> {{ instarea.tarea.get_objeto_display }}
        {% endif %}
    </div>
    <div class="columns large-6">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Centro</b><select class="centro" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for c in centros %}
                    <option value="{{ c.id }}" {% if instarea.tarea.centro_mdb.id == c.id %}selected{% endif %}>{{ c.nombre }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Centro </b></label> {{ instarea.tarea.centro_mdb.nombre }}
        {% endif %}
    </div>
    <div class="columns large-3">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Localización</b><select class="selector" data-campo="localizacion" data-id="{{ instarea.id }}">
                <option value="">---------</option>
                {% for l in localizaciones %}
                    <option value="{{ l.0 }}" {% if instarea.tarea.localizacion == l.0 %}selected{% endif %}>{{ l.1 }}</option>
                {% endfor %}
            </select></label>
        {% else %}
            <label><b>Localización </b></label> {{ instarea.tarea.get_localizacion_display }}
        {% endif %}
    </div>
</div>

<div class="row">
    <div class="columns large-12">
        {% if instarea.inspector == g_e and not instarea.tarea.realizada %}
            <label><b>Observaciones</b>
                <div contenteditable="true" class="ckeditor update_texto observaciones"
                     data-id="{{ instarea.id }}" data-campo="observaciones">
                    {% autoescape off %}{{ instarea.tarea.observaciones }}{% endautoescape %}
                </div>
            </label>
        {% else %}
            <hr>
            <label><b>Observaciones</b></label> {% autoescape off %}
            {{ instarea.tarea.observaciones }}
        {% endautoescape %}
        {% endif %}
    </div>
</div>
{#<br>#}
{#<div class="row">#}
{#    <div class="columns large-12">#}
{#        {% with permiso="controla_instareas_"|add:instarea.tarea.tipo %}#}
{#            {% if g_e|has_permiso:permiso and not instarea.tarea.realizada %}#}
{#                <label><b>Descripción de la solución</b>#}
{#                    <div contenteditable="true" class="ckeditor describir_solucion"#}
{#                         data-id="{{ instarea.id }}">#}
{#                        {% autoescape off %}{{ instarea.describir_solucion }}{% endautoescape %}#}
{#                    </div>#}
{#                </label>#}
{#            {% else %}#}
{#                <label><b>Descripción de la solución</b></label> {% autoescape off %}#}
{#                {{ instarea.describir_solucion }}#}
{#            {% endautoescape %}#}
{#            {% endif %}#}
{#        {% endwith %}#}
{#    </div>#}
{#</div>#}
{#<br>#}
{#{% if instarea.inspector == g_e and not instarea.comunicado_a_reparador %}#}
{#<div class="row" id="enviar_mensaje{{ instarea.id }}">#}
{#    <div class="columns large-12">#}
{#        <b>Esta solicitud de reparación se borrará automáticamente si no pulsas "Aceptar"</b>#}
{#    </div>#}
{#    <div class="columns large-12">#}
{#        <a class="button enviar_mensaje" data-id="{{ instarea.id }}">Aceptar</a>#}
{#    </div>#}
{#</div>#}
{#{% endif %}#}
<script>
    $('select').select2();
</script>