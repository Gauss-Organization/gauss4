{% extends "base_select2-4.html" %}
{#{% load my_templatetags %}#}

{% block contenido %}
    <form action="" method="post" enctype="multipart/form-data" id="tareas_ie" name="tareas_ie">
        {% csrf_token %}

        <div class="">
            <h4 style="text-align: center;color: #008CBA;"><strong> Tareas de Inspección</strong></h4>
        </div>


{#        <div class="panel callout">#}
{#            <div class="row">#}
{#                <div class="large-4 columns">#}
{#                    <b>Archivo xml (Racima y Peñalara):</b>#}
{#                </div>#}
{#                <div class="large-8 columns">#}
{#                    <input type="file" name="file_masivo" id="file_masivo"/>#}
{#                </div>#}
{#            </div>#}
{#            <hr>#}
{#            <div class="row">#}
{#                <div class="large-12 columns">#}
{#                    <p>Este formulario sirve para cargar dos archivos diferentes:</p>#}
{#                    <ol>#}
{#                        <li><b>El primero se obtiene de:</b>#}
{#                            Racima <i class="fa fa-long-arrow-right"></i> Utilidades#}
{#                            <i class="fa fa-long-arrow-right"></i> Intercambios de información#}
{#                            <i class="fa fa-long-arrow-right"></i> Exportar datos desde Gestión de Centros#}
{#                            <i class="fa fa-long-arrow-right"></i> Exportación hacia generadores de horarios#}
{#                        </li>#}
{#                        <li><b>El segundo de:</b>#}
{#                            Peñalara <i class="fa fa-long-arrow-right"></i> Exportar#}
{#                            <i class="fa fa-long-arrow-right"></i> Plumier#}
{#                        </li>#}
{#                    </ol>#}
{#                    <p><i>GAUSS distinguirá automáticamente uno de otro.</i></p>#}
{#                </div>#}
{#            </div>#}
{#        </div>#}

        <div class="panel callout">
            <div class="row">
                    <div class="large-12 columns">
                        <p>Este formulario sirve para cargar los horarios de los profesores a través de un
                            archivo XLS obtenido de Racima.</p>
                        <ul>
                            <li><b>La ruta para obtenerlo es:</b> Racima <i class="fa fa-long-arrow-right"></i> Módulo
                                de Gestión
                                <i class="fa fa-long-arrow-right"></i> Seguimiento
                                <i class="fa fa-long-arrow-right"></i> Catálogo de consultas
                                <i class="fa fa-long-arrow-right"></i> <i>Elegir módulo "Empleados"</i>
                                <i class="fa fa-long-arrow-right"></i> <i>Elegir consulta "Horario del profesorado
                                del centro con sus materias"</i>
                                <i class="fa fa-long-arrow-right"></i> Exportar datos (XLS)
                            </li>
                        </ul>
                    </div>
                </div>
            <hr>
            <div class="row">
                <div class="large-3 columns">
                    <b>Archivo xls (Racima):</b>
                </div>
                <div class="large-6 columns">
                    <input type="file" name="file_masivo_xls" id="file_masivo_xls"/>
                </div>
                <div class="large-3 columns">
                    <a class="button" id="archivo_xls">Cargar el archivo xls</a>
                </div>
            </div>
{#            <hr>#}
{#            <div class="row">#}
{#                <div class="large-12 columns">#}
{#                    <a class="button" id="archivo_xls">Cargar el archivo xls</a>#}
{#                </div>#}
{#            </div>#}
{##}
{#            <hr>#}



        </div>
        {% if 'especialidades' in incidencias %}
            {{ incidencias.especialidades }}
        {% endif %}
    </form>

{% endblock %}


{% block final %}
    <script>

        {#habilita(['s_check']);#}
        {#$('#check_sign').click(function (e) {#}
        {#    e.preventDefault();#}
        {#    if ($('#file_masivo').val()) {#}
        {#        $('#action').val('carga_masiva_racima_xml');#}
        {#        document.{{formname}}.submit();#}
        {#    } else {#}
        {#        show_mensajes({#}
        {#            title: '<i class="fa fa-warning"></i> No has cargado un archivo', texto: 'Para ' +#}
        {#            'subir un archivo primero debes cargarlo pulsando en "Examinar..."'#}
        {#        })#}
        {#    }#}
        {# });#}

        $('#archivo_xls').click(function (e) {
            e.preventDefault();
            if ($('#file_masivo_xls').val()) {
                $('#action').val('carga_masiva_racima_xls');
                document.{{formname}}.submit();
            } else {
                show_mensajes({
                    title: '<i class="fa fa-warning"></i> No has cargado un archivo!!!!', texto: 'Para ' +
                    'subir un archivo primero debes cargarlo pulsando en "Examinar..."'
                })
            }
        });

        $('body').on('change', '.especialidad', function () {
            var gep = $(this).data('id');
            var especialidad = $(this).val();
            $.post("/carga_masiva_horarios/", {action: 'update_especialidad', gep: gep, especialidad: especialidad},
                function (data) {
                    if (data.ok) {
                        $("#update_ok").show().delay(1500).fadeOut();
                    } else {
                        $("#update_error").show().delay(1500).fadeOut();
                    }
                });
        });

        $('body').on('change', '.departamento', function () {
            var gep = $(this).data('id');
            var departamento = $(this).val();
            $.post("/carga_masiva_horarios/", {action: 'update_departamento', gep: gep, departamento: departamento},
                function (data) {
                    if (data.ok) {
                        $("#update_ok").show().delay(1500).fadeOut();
                    } else {
                        $("#update_error").show().delay(1500).fadeOut();
                    }
                });
        });



    </script>
{% endblock %}