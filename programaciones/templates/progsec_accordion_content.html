{% load entidades_extras %}
{% load programaciones_extras %}
<style>
    p {
        text-align: justify;
    }

    .span_periodos {
        color: darkred;
    }

    {% for sb in progsec.saberbas_set.all %}
        #row_sb_botones{{ sb.id }} {
            display: none;
            position: absolute;
            top: 1px;
            right: 35px;
        }
        #row_sb{{ sb.id }} {
            position: relative;
        }
        #row_sb{{ sb.id }}:hover #row_sb_botones{{ sb.id }} {
            display: block;
        }
        #row_sb{{ sb.id }}:hover {
            border-top: 1px solid #ebccd1;
        }
        {% for sap in sb.sitapren_set.all %}
            #row_sap_botones{{ sb.id }} {
                display: none;
                position: absolute;
                top: 1px;
                right: 35px;
            }
            #row_sap{{ sb.id }} {
                position: relative;
            }
            #row_sap{{ sb.id }}:hover #row_sap_botones{{ sb.id }} {
                display: block;
            }
            #row_sap{{ sb.id }}:hover {
                border-top: 1px solid #ebccd1;
            }
        {% endfor %}
    {% endfor %}


</style>
<div class="row">
    <div class="columns large-12">
        <ul class="button-group right">
            {% if gep.ge.gauser.username == 'gauss' or progsec|puede_borrar:gep.ge %}
                <li><a class="button alert borrar_progsec tiny" data-id="{{ progsec.id }}"
                       title="Borrar completamente este informe de la base de datos"><i class="fa fa-trash-o"></i>
                    Borrar</a></li>
            {% endif %}
            <li><a class="button copiar_progsec tiny" data-id="{{ progsec.id }}"
                   title="Hacer una copia (un duplicado) de este informe"><i class="fa fa-copy"></i> Copiar</a>
            </li>
            <li><a class="button pdf_progsec tiny" data-id="{{ progsec.id }}"
                   title="Crear un PDF de este informe"><i class="fa fa-file-pdf-o"></i> PDF</a>
            </li>
        </ul>
    </div>
</div>
<div class="row">
    <div class="columns large-12">
        <label><b>Nombre específico: </b>
            <input type="text" class="update_texto nombre" data-campo="nombre" data-id="{{ progsec.id }}"
                   id="input_nombre{{ progsec.id }}" value="{{ progsec.nombre }}"
                   placeholder="Introduce aquí el nombre específico para la programación"></label>
    </div>
</div>

<div id="docentes_progsec{{ progsec.id }}">
    <div class="row">
        <div class="columns large-6">
            <label><b>Departamento: </b>
                <select class="select_departamento" data-progsec="{{ progsec.id }}">
                    <option value="">------</option>
                    {% for d in departamentos %}
                        <option value="{{ d.id }}"
                                {% if progsec.departamento == d %}selected{% endif %}>{{ d.nombre }}</option>
                    {% endfor %}
                </select>
            </label>
        </div>
        <div class="columns large-6">
            <label><b>Jefe/a del departamento: </b>
                <select class="select_jefe" data-progsec="{{ progsec.id }}">
                    <option value="">------</option>
                    {% for d in docentes %}
                        <option value="{{ d.id }}"
                                {% if gep.departamento.jefe.ge == d %}selected{% endif %}>{{ d.gauser.get_full_name }}</option>
                    {% endfor %}
                </select>
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label><b>Docentes del departamento usando esta programación (tendrán permiso para editarla): </b>
                <select class="miembros_departamento" data-progsec="{{ progsec.id }}" multiple="multiple">
                    <option value="">------</option>
                    {% for d in docentes %}
                        <option value="{{ d.id }}"
                                {% if d.id in docentes_id %}selected{% endif %}>{{ d.gauser.get_full_name }}</option>
                    {% endfor %}
                </select>
            </label>
        </div>
    </div>
</div>
<br>

<div id="contenido_progsec{{ progsec.id }}">
    <div class="row">
        <div class="columns large-12">
            <div class="panel callout"><h3>1º Dar un peso a cada competencia específica</h3></div>
            <p>La superación de {{ progsec.areamateria.nombre }} implica la adquisición de una serie de competencias
                específicas. Cada una de ellas contribuirá en parte a la calificación que finalmente obtendrán sus
                alumunos. No obstante, es posible que su departamento considere que una competencia específica tenga más
                importancia que otras en la calificación final. Esta importancia la puede fijar introduciendo un "peso"
                a cada competencia específica; este peso se representa por un número asociado a dicha competencia.
                Cuanto mayor es el peso (el número asignado) mayor es la importancia de la competencia.</p>
        </div>
    </div>

    <div class="row">
        <div class="columns large-12">
            <table style="width: 100%;">
                <thead>
                <tr>
                    <th>Competencia específica</th>
                    <th>Peso</th>
                </tr>
                </thead>
                {% for cep in progsec.ceprogsec_set.all %}
                    <tr>
                        <td>{{ cep.ce.orden }}.- {{ cep.ce.nombre }}</td>
                        <td><input type="number" min="1" max="10" class="pesocep" data-cep="{{ cep.id }}"
                                   data-progsec="{{ progsec.id }}" value="{{ cep.valor|floatformat }}"></td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <p style="color: gray;">La calificación de {{ progsec.areamateria.nombre }} se calculará a través de la
                siguiente media ponderada:</p>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12" style="text-align: left;">
            calificación {{ progsec.areamateria.nombre }} =
        </div>
    </div>
    <div class="row">
        <div class="columns large-12" style="text-align: center;">
            <div>
                {% for ce in progsec.ceprogsec_set.all %}
                    <span title="Calificación obtenida en la competencia específica {{ ce.ce.orden }}"
                    >CE{{ ce.ce.orden }}</span>&nbsp;×&nbsp;<span class="valor_ce{{ ce.id }}"
                >{{ ce.valor|floatformat }}</span>{% if not forloop.last %}&nbsp;+&nbsp;{% endif %}{% endfor %}
            </div>
            <div style="border-top: 1px solid black;">
                {% for ce in progsec.ceprogsec_set.all %}
                    <span class="valor_ce{{ ce.id }}">{{ ce.valor|floatformat }}</span
                    >{% if not forloop.last %}&nbsp;+&nbsp;{% endif %}{% endfor %}
            </div>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <p style="color: gray;">En la anterior fórmula, CE1 es la calificación que un alumno obtiene en la
                competencia específica 1,
                <br>En la anterior fórmula, CE2 es la calificación que un alumno obtiene en la
                competencia específica 2,
                <br>...
                <br>CEn sería la calificación obtenida en la competencia específica "n".</p>
        </div>
    </div>

    <div class="row">
        <div class="columns large-12">
            <div class="panel callout"><h3>2º Dar un peso a cada criterio de evaluación</h3></div>
            <p>Para concretar el nivel de adquisición de cada competencia específica, usted utilizará una serie
                de criterios de evaluación. De este modo, las competencias no las evaluará directamente, sino que lo
                hará a través los citados criterios; que a su vez servirán de referencia para generar la calificación
                obtenida por un/a alumno/a.</p>
            <p>Cada criterio de evaluación puede tener, a su vez, un "peso" que determina
                su contribución ponderada a la valoración del grado de adquisición de la competencia específica. Por
                favor, introduzca el peso asociado a cada criterio de evaluación:</p>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <p style="color: gray;">La calificación de la CE{{ cep.orden }} será la
                media ponderada de las calificaciones que usted otorgue a cada alumno en cada criterio de evaluación.
                <br>La fórmula de cálculo es similar a la indicada anteriormente para {{ progsec.areamateria.nombre }},
                pero utilizando los criterios de evaluación.</p>
        </div>
    </div>

    {% comment %}
    {% for cep in progsec.ceprogsec_set.all %}
        <div class="row">
            <div class="columns large-12">
                <b>{{ cep.ce.nombre }}</b>
            </div>
        </div>
        {% for cevp in cep.cevprogsec_set.all %}
            <div class="row">
                <div class="columns large-10">
                    {{ cevp.cev.texto }}
                </div>
                <div class="columns large-2">
                    <input type="number" min="1" max="10" class="pesocevp" data-cevp="{{ cevp.id }}"
                           data-progsec="{{ progsec.id }}" value="{{ cevp.valor|floatformat }}">
                </div>
            </div>
        {% endfor %}
    {% endfor %}
{% endcomment %}
    <div class="row">
        <div class="columns large-12">
            <table style="width: 100%;">
                <thead>
                <tr>
                    <th>Competencia específica con sus criterios de evaluación asociados</th>
                    <th>Peso</th>
                </tr>
                </thead>
                {% for cep in progsec.ceprogsec_set.all %}
                    <thead>
                    <tr>
                        <th colspan="2">{{ cep.ce.orden }}.- {{ cep.ce.nombre }}</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for cevp in cep.cevprogsec_set.all %}
                        <tr>
                            <td>{{ cevp.cev.texto }}</td>
                            <td><input type="number" min="1" max="10" class="pesocevp" data-cevp="{{ cevp.id }}"
                                       data-progsec="{{ progsec.id }}" value="{{ cevp.valor|floatformat }}"></td>
                        </tr>
                    {% endfor %}
                    </tbody>
                {% endfor %}
            </table>
        </div>
    </div>

    <div class="row">
        <div class="columns large-12 callout panel">
            <h3>3º Libros o materiales van a ser utilizados para el desarrollo de la materia</h3>
            {#            <p>Indique los libros/materiales que van utilizarse para desarrollar:</p>#}
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <table id="lista_libros{{ progsec.id }}" style="width: 100%;">
                <thead>
                <tr>
                    <th>Nombre</th>
                    <th>ISBN</th>
                    <th>¿Borrar?</th>
                </tr>
                </thead>
                <tbody>
                {% for libro in progsec.librorecurso_set.all %}
                    {% include "progsec_accordion_content_libro.html" %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="columns large-9">
            <label>Introduce nombre del libro/material:
                <input type="text" id="nombre_libro{{ progsec.id }}" value="" placeholder="Obligatorio">
            </label>
        </div>
        <div class="columns large-3">
            <label>Introduce el ISBN:
                <input type="text" id="isbn_libro{{ progsec.id }}" value="" placeholder="Opcional">
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label>Introduce observaciones acerca del libro/material:
                <textarea id="observaciones_libro{{ progsec.id }}"
                          placeholder="Texto opcional"></textarea>
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-9">
            <label>Cargar el archivo del libro/material (opcional):
                <input type="file" disabled="disabled" name="archivo_libro{{ progsec.id }}"
                       id="archivo_libro{{ progsec.id }}">
            </label>
        </div>
        <div class="columns large-3">
            <a data-progsec="{{ progsec.id }}" class="button right cargar_libro">Cargar libro/material</a>
        </div>
    </div>

    <div class="row">
        <div class="columns large-12">
            <div class="panel callout">
                <h3>4º Actividades extraescolares/complementarias que se van a llevar a cabo</h3>
            </div>
            {#            <p>Indique los libros/materiales que van utilizarse para desarrollar:</p>#}
        </div>
    </div>

    <div class="row">
        <div class="columns large-12">
            <table id="lista_actex{{ progsec.id }}" style="width: 100%;">
                <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Inicio</th>
                    <th>Fin</th>
                    <th>¿Borrar?</th>
                </tr>
                </thead>
                <tbody>
                {% for actex in progsec.actexcom_set.all %}
                    {% include "progsec_accordion_content_actex.html" %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="columns large-8">
            <label>Nombre de la actividad extraescolar/complementaria:
                <input type="text" data-progsec="{{ progsec.id }}" id="nombre_actex{{ progsec.id }}" value=""
                       placeholder="Obligatorio">
            </label>
        </div>
        <div class="columns large-2">
            <label>Inicio:
                <input type="date" data-progsec="{{ progsec.id }}" id="inicio_actex{{ progsec.id }}" value=""
                       placeholder="Obligatorio">
            </label>
        </div>
        <div class="columns large-2">
            <label>Fin:
                <input type="date" data-progsec="{{ progsec.id }}" id="fin_actex{{ progsec.id }}" value=""
                       placeholder="Obligatorio">
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-9">
            <label>Observaciones a la actividad extraescolar/complementaria:
                <textarea data-progsec="{{ progsec.id }}" id="observaciones_actex{{ progsec.id }}"
                          placeholder="Texto opcional"></textarea>
            </label>
        </div>
        <div class="columns large-3">
            <label>&nbsp;<br>
                <a data-progsec="{{ progsec.id }}" class="button right cargar_actex">Cargar actividad</a>
            </label>
        </div>
    </div>


    <div class="row">
        <div class="columns large-12">
            <div class="panel callout">
                <h3>5º Unidades de programación</h3>
            </div>
            <p>Las unidades de programación organizan la acción didáctica orientada hacia la adquisición de
                competencias. En este proceso se desarrollan los saberes básicos (conocimientos, destrezas y actitudes),
                cuyo aprendizaje resulta necesario para la adquisición de compentecias.</p>
            <p>En este apartado, usted debe secuenciar las diferentes unidades de programación asociadas con la materia
                ({{ progsec.areamateria.nombre }}) e indicar el número de periodos lectivos que estima serán necesarios
                para impartir la docencia correspondiente. Recuerde que cada unidad de programación puede contener
                saberes de diferentes bloques.</p>
        </div>
    </div>

    <div class="row">
        <div class="columns large-12">
            <table id="lista_saber{{ progsec.id }}" style="width: 100%;">
                <thead>
                <tr>
                    <th>orden</th>
                    <th>nombre</th>
                    <th>periodos</th>
                    <th>¿Borrar?</th>
                    <th title="Situaciones de aprendizaje">SAP</th>
                </tr>
                </thead>
                <tbody id="tbody_saberes{{ progsec.id }}">
                {% include "progsec_accordion_content_saberes.html" %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <a data-progsec="{{ progsec.id }}" class="add_saber button small right">Añadir Saber básico</a>
        </div>
    </div>
    {% comment %}
    {% for sb in progsec.saberbas_set.all %}
        <div class="row" id="row_sb{{ sb.id }}">
            <div class="columns large-12">
                <p><b>{{ sb.orden }}.- {{ sb.nombre }} (<span class="span_periodos">{{ sb.periodos }} periodos</span>
                    )</b></p>
            </div>
            <div id="row_sb_botones{{ sb.id }}">
                <ul class="button-group right">
                    <li><a class="button alert borrar_sb tiny" data-id="{{ progsec.id }}"
                           title="Borrar completamente este saber básico de la base de datos"><i
                            class="fa fa-trash-o"></i>
                        Borrar</a></li>
                    <li><a class="button ordensube_sb tiny" data-id="{{ progsec.id }}"
                           title="Aumentar en 1 el orden de este saber básico"><i class="fa fa-arrow-up"></i></a>
                    </li>
                    <li><a class="button ordenbaja_sb tiny" data-id="{{ progsec.id }}"
                           title="Reducir en 1 el orden de este saber básico"><i class="fa fa-arrow-down"></i></a>
                    </li>
                    <li><a class="button add_sap tiny" data-id="{{ progsec.id }}" href="/progsecundaria_sb/{{ sb.id }}/"
                           title="Añadir situaciones de aprendizaje a este saber básico"><i class="fa fa-plus"></i>
                        SAP</a>
                    </li>
                </ul>
            </div>
        </div>

        {% for sap in sb.sitapren_set.all %}
            <div class="row" id="row_sap{{ sap.id }}">
                <div class="columns large-12">
                    <p><b>{{ sap.nombre }}</b></p>
                    <p style="color: darkblue;">{{ sap.objetivo }}</p>
                </div>
                <div id="row_sap_botones{{ sap.id }}">
                    <ul class="button-group right">
                        <li><a class="button alert borrar_sap tiny" data-id="{{ progsec.id }}"
                               title="Borrar completamente este saber básico de la base de datos"><i
                                class="fa fa-trash-o"></i>
                            Borrar</a></li>
                        <li><a class="button add_asap tiny" data-id="{{ progsec.id }}"
                               title="Añadir una actividad asociada a esta situación de aprendizaje"><i
                                class="fa fa-plus"></i>
                            ASAP</a>
                        </li>
                    </ul>
                </div>
            </div>
        {% endfor %}
    {% endfor %}






    <div class="row">
        <div class="columns large-1">
            <label>Orden:
                <input type="number" min="1" data-progsec="{{ progsec.id }}" class="saberbas" data-campo="orden"
                       value="">
            </label>
        </div>
        <div class="columns large-7">
            <label>Nombre:
                <input type="text" data-progsec="{{ progsec.id }}" data-campo="nombre" value="" class="saberbas">
            </label>
        </div>
        <div class="columns large-2">
            <label title="Número de peridos lectivos que se estima que van a ser necesarios para impartir el contenido"
            >Periodos:<input type="number" data-progsec="{{ progsec.id }}" class="saberbas" value=""
                             data-campo="periodos">
            </label>
        </div>
        <div class="columns large-2">
            <label>&nbsp;<br>
                <a class="button tiny right">Guardar</a>
            </label>
        </div>
    </div>



    <div class="row">
        <div class="columns large-12">
            <div class="panel callout">
                <h3>5º Saberes básicos que se van a impartir</h3>
            </div>
            <p>Los saberes básicos constituyen los contenidos de la materia que se explican a los alumnos
                a lo largo del curso y que les permiten adquirir las competencias específicas.</p>
            <p>En este apartado debe secuenciar los contenidos asociados a su materia e indicar el número de periodos
                lectivos que estima necesarios para impartir la docencia correspondiente.</p>
        </div>
    </div>
    <div class="row">
        <div class="columns large-1">
            <label>Orden:
                <input type="number" min="1" data-progsec="{{ progsec.id }}" class="saberbas" data-campo="orden"
                       value="">
            </label>
        </div>
        <div class="columns large-7">
            <label>Nombre:
                <input type="text" data-progsec="{{ progsec.id }}" data-campo="nombre" value="" class="saberbas">
            </label>
        </div>
        <div class="columns large-2">
            <label title="Número de peridos lectivos que se estima que van a ser necesarios para impartir el contenido"
            >Periodos:<input type="number" data-progsec="{{ progsec.id }}" class="saberbas" value=""
                             data-campo="periodos">
            </label>
        </div>
        <div class="columns large-2">
            <label>&nbsp;<br>
                <a class="button tiny right">Guardar</a>
            </label>
        </div>
    </div>


    <div class="row">
        <div class="columns large-12">
            <div class="panel callout">
                <h3>6º Situaciones de aprendizaje ligadas a los saberes básicos</h3>
            </div>
            <p>Los "saberes básicos" (SB) se adquieren a través de "situaciones de aprendizaje" (SAP), que
                a su vez pueden estar compuestas por una o más "actividades de aprendizaje" (ACAP).</p>
            <p>Estas actividades de aprendizaje deben ser evaluadas utilizando procedimientos/técnicas de evaluación
                (en ocasiones llamados incorrectamente "Instrumentos de evaluación") a través unos criterios de
                evaluación que establece la normativa y que ya han sido indicados anteriormente (apartado 2º de
                esta programación).</p>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label>Selecciona uno de los "saberes básicos" que has indicado anteriormente:
                <select data-progsec="{{ progsec.id }}" class="select_saberbas"></select>
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-1">
            <label>Orden:
                <input type="number" min="1" data-progsec="{{ progsec.id }}" class="saberbas" data-campo="orden"
                       value="">
            </label>
        </div>
        <div class="columns large-7">
            <label>Nombre:
                <input type="text" data-progsec="{{ progsec.id }}" data-campo="nombre" value="" class="saberbas">
            </label>
        </div>
        <div class="columns large-2">
            <label title="Número de peridos lectivos que se estima que van a ser necesarios para impartir el contenido"
            >Periodos:<input type="number" data-progsec="{{ progsec.id }}" class="saberbas" value=""
                             data-campo="periodos">
            </label>
        </div>
        <div class="columns large-2">
            <label>&nbsp;<br>
                <a class="button tiny right">Guardar</a>
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label>Actividades extraescolares/complementarias ligadas a este contenido:
                <select data-progsec="{{ progsec.id }}" class="saberbas" data-campo="actexcoms"></select>
            </label>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label>Libros/materiales utilizados en este contenido:
                <select data-progsec="{{ progsec.id }}" class="saberbas" data-campo="librorecursos"></select>
            </label>
        </div>
    </div>

    <div class="row">
        <div title="Situaciones de aprendizaje diseñadas para que el alumnado adquiera este saber básico"
             class="columns large-12"><p><b>Situaciones de aprendizaje:</b></p>
        </div>
    </div>
    <div class="row">
        <div class="columns large-12">
            <label>Libros/materiales utilizados en este contenido:
                <select data-progsec="{{ progsec.id }}" class="saberbas" data-campo="librorecursos"></select>
            </label>
        </div>
    </div>

</div>
{#<div class="row">#}
{#    <div class="columns large-12">#}
{#        <label><b>Archivos adjuntos al informe </b></label>#}
{#    </div>#}
{#</div>#}
{#<div class="row">#}
{#    <div class="columns large-12">#}
{#        <table>#}
{#            <tbody id="tbody_gauss_file{{ progsec.id }}">#}
{#            </tbody>#}
{#        </table>#}
{#    </div>#}
{#</div>#}
{#<div class="row">#}
{#    <div class="columns large-8">#}
{#        <label><input type="file" id="input_gauss_file{{ progsec.id }}" multiple="multiple"></label>#}
{#    </div>#}
{#    <div class="columns large-4">#}
{#        <a class="button tiny subir_gauss_file" data-id="{{ progsec.id }}"><i class="fa fa-cloud-upload"></i> Cargar#}
{#            archivos</a>#}
{#    </div>#}
{#</div>#}

{% endcomment %}
    <script>
        $('select').select2();
    </script>